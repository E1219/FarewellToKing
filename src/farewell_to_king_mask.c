/*
 farewell_to_king_mask.c
 Farewell To King - Chess Library
 Edward Sandor
 January 2015 - 2020
 
 Contains implementation of all methods used to generate and manipulate board masks.
*/

#include <stdlib.h>

#include "farewell_to_king_bitops.h"
#include "farewell_to_king_mask.h"
#include "farewell_to_king_types.h"

ftk_board_mask_t ftk_build_type_mask(const ftk_board_s *board, ftk_type_e type) 
{
  ftk_board_mask_t mask = 0;

  int i;
  ftk_board_mask_t biterator = 1ULL;

  for (i = 0; i < FTK_STD_BOARD_SIZE; i++) {
    if (board->square[i].type == type) {
      mask = mask | biterator;
    }
    biterator = (biterator << 1);
  }

  return mask;
}

ftk_board_mask_t ftk_build_color_mask(const ftk_board_s *board, ftk_color_e color) 
{
  ftk_board_mask_t mask = 0;

  int i;
  ftk_board_mask_t biterator = 1ULL;

  for (i = 0; i < FTK_STD_BOARD_SIZE; i++) {
    if (board->square[i].color == color) {
      mask = mask | biterator;
    }
    biterator = (biterator << 1);
  }

  return mask;
}

ftk_board_mask_t ftk_build_board_mask(const ftk_board_s *board) {
  ftk_board_mask_t mask = 0;

  int i;
  ftk_board_mask_t biterator = 1ULL;
  for (i = 0; i < FTK_STD_BOARD_SIZE; i++) {
    if (board->square[i].type != FTK_TYPE_EMPTY) {
      mask = mask | biterator;
    }
    biterator = (biterator << 1);
  }

  return mask;
}

void ftk_build_all_masks(ftk_board_s *board)
{
  board->board_mask = 0;
  board->white_mask = 0;
  board->black_mask = 0;
  board->pawn_mask = 0;
  board->knight_mask = 0;
  board->bishop_mask = 0;
  board->rook_mask = 0;
  board->queen_mask = 0;
  board->king_mask = 0;

  int i;
  ftk_board_mask_t biterator = 1ULL;
  for(i=0;i<FTK_STD_BOARD_SIZE;i++)
  {
    if(board->square[i].type != FTK_TYPE_EMPTY)
    {
      board->board_mask |= biterator;
      if(board->square[i].color == FTK_COLOR_WHITE)
      {
        board->white_mask |= biterator;
      }
      else
      {
        board->black_mask |= biterator;
      }
      switch(board->square[i].type){
        case FTK_TYPE_PAWN:
          board->pawn_mask   |= biterator;
          break;
        case FTK_TYPE_KNIGHT:
          board->knight_mask |= biterator;
          break;
        case FTK_TYPE_BISHOP:
          board->bishop_mask |= biterator;
          break;
        case FTK_TYPE_ROOK:
          board->rook_mask   |= biterator;
          break;
        case FTK_TYPE_QUEEN:
          board->queen_mask  |= biterator;
          break;
        case FTK_TYPE_KING:
          board->king_mask   |= biterator;
          break;
        default:
            break;
      }
    }
    biterator = biterator << 1;
  }
}

static const ftk_board_mask_t white_pawn_capture_mask[FTK_STD_BOARD_SIZE] = 
{
  0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
  0x0000000000020000, 0x0000000000050000, 0x00000000000a0000, 0x0000000000140000, 0x0000000000280000, 0x0000000000500000, 0x0000000000a00000, 0x0000000000400000, 
  0x0000000002000000, 0x0000000005000000, 0x000000000a000000, 0x0000000014000000, 0x0000000028000000, 0x0000000050000000, 0x00000000a0000000, 0x0000000040000000, 
  0x0000000200000000, 0x0000000500000000, 0x0000000a00000000, 0x0000001400000000, 0x0000002800000000, 0x0000005000000000, 0x000000a000000000, 0x0000004000000000, 
  0x0000020000000000, 0x0000050000000000, 0x00000a0000000000, 0x0000140000000000, 0x0000280000000000, 0x0000500000000000, 0x0000a00000000000, 0x0000400000000000, 
  0x0002000000000000, 0x0005000000000000, 0x000a000000000000, 0x0014000000000000, 0x0028000000000000, 0x0050000000000000, 0x00a0000000000000, 0x0040000000000000, 
  0x0200000000000000, 0x0500000000000000, 0x0a00000000000000, 0x1400000000000000, 0x2800000000000000, 0x5000000000000000, 0xa000000000000000, 0x4000000000000000, 
  0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
};

static const ftk_board_mask_t black_pawn_capture_mask[FTK_STD_BOARD_SIZE] = 
{
  0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
  0x0000000000000002, 0x0000000000000005, 0x000000000000000a, 0x0000000000000014, 0x0000000000000028, 0x0000000000000050, 0x00000000000000a0, 0x0000000000000040, 
  0x0000000000000200, 0x0000000000000500, 0x0000000000000a00, 0x0000000000001400, 0x0000000000002800, 0x0000000000005000, 0x000000000000a000, 0x0000000000004000, 
  0x0000000000020000, 0x0000000000050000, 0x00000000000a0000, 0x0000000000140000, 0x0000000000280000, 0x0000000000500000, 0x0000000000a00000, 0x0000000000400000, 
  0x0000000002000000, 0x0000000005000000, 0x000000000a000000, 0x0000000014000000, 0x0000000028000000, 0x0000000050000000, 0x00000000a0000000, 0x0000000040000000, 
  0x0000000200000000, 0x0000000500000000, 0x0000000a00000000, 0x0000001400000000, 0x0000002800000000, 0x0000005000000000, 0x000000a000000000, 0x0000004000000000, 
  0x0000020000000000, 0x0000050000000000, 0x00000a0000000000, 0x0000140000000000, 0x0000280000000000, 0x0000500000000000, 0x0000a00000000000, 0x0000400000000000, 
  0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 
};

static const ftk_board_mask_t knight_move_mask[FTK_STD_BOARD_SIZE] = 
{
  0x0000000000020400, 0x0000000000050800, 0x00000000000a1100, 0x0000000000142200, 0x0000000000284400, 0x0000000000508800, 0x0000000000a01000, 0x0000000000402000, 
  0x0000000002040004, 0x0000000005080008, 0x000000000a110011, 0x0000000014220022, 0x0000000028440044, 0x0000000050880088, 0x00000000a0100010, 0x0000000040200020, 
  0x0000000204000402, 0x0000000508000805, 0x0000000a1100110a, 0x0000001422002214, 0x0000002844004428, 0x0000005088008850, 0x000000a0100010a0, 0x0000004020002040, 
  0x0000020400040200, 0x0000050800080500, 0x00000a1100110a00, 0x0000142200221400, 0x0000284400442800, 0x0000508800885000, 0x0000a0100010a000, 0x0000402000204000, 
  0x0002040004020000, 0x0005080008050000, 0x000a1100110a0000, 0x0014220022140000, 0x0028440044280000, 0x0050880088500000, 0x00a0100010a00000, 0x0040200020400000, 
  0x0204000402000000, 0x0508000805000000, 0x0a1100110a000000, 0x1422002214000000, 0x2844004428000000, 0x5088008850000000, 0xa0100010a0000000, 0x4020002040000000, 
  0x0400040200000000, 0x0800080500000000, 0x1100110a00000000, 0x2200221400000000, 0x4400442800000000, 0x8800885000000000, 0x100010a000000000, 0x2000204000000000, 
  0x0004020000000000, 0x0008050000000000, 0x00110a0000000000, 0x0022140000000000, 0x0044280000000000, 0x0088500000000000, 0x0010a00000000000, 0x0020400000000000, 
};

static const ftk_board_mask_t king_move_mask[FTK_STD_BOARD_SIZE] = 
{
  0x0000000000000302, 0x0000000000000705, 0x0000000000000e0a, 0x0000000000001c14, 0x0000000000003828, 0x0000000000007050, 0x000000000000e0a0, 0x000000000000c040, 
  0x0000000000030203, 0x0000000000070507, 0x00000000000e0a0e, 0x00000000001c141c, 0x0000000000382838, 0x0000000000705070, 0x0000000000e0a0e0, 0x0000000000c040c0, 
  0x0000000003020300, 0x0000000007050700, 0x000000000e0a0e00, 0x000000001c141c00, 0x0000000038283800, 0x0000000070507000, 0x00000000e0a0e000, 0x00000000c040c000, 
  0x0000000302030000, 0x0000000705070000, 0x0000000e0a0e0000, 0x0000001c141c0000, 0x0000003828380000, 0x0000007050700000, 0x000000e0a0e00000, 0x000000c040c00000, 
  0x0000030203000000, 0x0000070507000000, 0x00000e0a0e000000, 0x00001c141c000000, 0x0000382838000000, 0x0000705070000000, 0x0000e0a0e0000000, 0x0000c040c0000000, 
  0x0003020300000000, 0x0007050700000000, 0x000e0a0e00000000, 0x001c141c00000000, 0x0038283800000000, 0x0070507000000000, 0x00e0a0e000000000, 0x00c040c000000000, 
  0x0302030000000000, 0x0705070000000000, 0x0e0a0e0000000000, 0x1c141c0000000000, 0x3828380000000000, 0x7050700000000000, 0xe0a0e00000000000, 0xc040c00000000000, 
  0x0203000000000000, 0x0507000000000000, 0x0a0e000000000000, 0x141c000000000000, 0x2838000000000000, 0x5070000000000000, 0xa0e0000000000000, 0x40c0000000000000, 
};

static inline ftk_board_mask_t ftk_build_move_mask_raw(ftk_square_s square, ftk_board_mask_t board_mask, ftk_board_mask_t opponent_mask, ftk_square_e position, ftk_square_e *ep)
{
  ftk_board_mask_t mask = 0;

  if (square.type == FTK_TYPE_PAWN) 
  {
    int direction = (square.color == FTK_COLOR_WHITE)
                        ? 1
                        : -1;             // change direction based on color
    int test = position + (direction << 3); // forward/back 1

    if (test < FTK_STD_BOARD_SIZE && test >= 0 &&
        ((board_mask & 1ULL << test) == 0)) {
      mask |= (1ULL << test);

      test = position + (direction << 4); // forward/back 2

      if ((square.moved == FTK_MOVED_NOT_MOVED) && test < FTK_STD_BOARD_SIZE &&
          test >= 0 && ((board_mask & 1ULL << test) == 0)) {
        mask |= (1ULL << test);
      }
    }

    const ftk_board_mask_t capture_mask = (square.color == FTK_COLOR_WHITE)?white_pawn_capture_mask[position]:black_pawn_capture_mask[position];
    mask |= (capture_mask & (opponent_mask | FTK_POSITION_TO_MASK(*ep)));
  } 
  else if (square.type == FTK_TYPE_KNIGHT) 
  {
    mask |= (knight_move_mask[position] & ((~board_mask) | opponent_mask));
  } 
  else if (square.type == FTK_TYPE_KING)
  {
    mask |= (king_move_mask[position] & ((~board_mask) | opponent_mask));
  }
  else if ( (square.type == FTK_TYPE_BISHOP) ||
            (square.type == FTK_TYPE_ROOK)   ||
            (square.type == FTK_TYPE_QUEEN) )
  {
    const ftk_board_mask_t movable_mask = ((~board_mask) | opponent_mask);
    if (square.type != FTK_TYPE_ROOK) 
    {
      int test = position + 9; // up-right diagonal
      ftk_board_mask_t test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             (test & 0x7) > (position & 0x7) &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test += 9;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
      test = position - 9; // down-left diagonal
      test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             (test & 0x7) < (position & 0x7) &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test -= 9;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
      test = position + 7; // up-left diagonal
      test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             (test & 0x7) < (position & 0x7) &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test += 7;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
      test = position - 7; // down-right diagonal
      test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             (test & 0x7) > (position & 0x7) &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test -= 7;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
    }
    if (square.type != FTK_TYPE_BISHOP) {
      int test = position + 1; // right horizontal
      ftk_board_mask_t test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             (test & 0x7) > (position & 0x7) &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test += 1;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
      test = position - 1; // left horizontal
      test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             (test & 0x7) < (position & 0x7) &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test -= 1;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
      test = position + 8; // up vertical
      test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test += 8;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
      test = position - 8; // down vertical
      test_mask = FTK_POSITION_TO_MASK(test);
      while (test < FTK_STD_BOARD_SIZE && test >= 0 &&
             ((test_mask & movable_mask) != 0))
      {
        mask |= test_mask;
        if ((board_mask & test_mask) != 0)
          break;
        test -= 8;
        test_mask = FTK_POSITION_TO_MASK(test);
      }
    }
  }

  return mask;
}
ftk_board_mask_t ftk_build_move_mask(const ftk_board_s *board, ftk_square_e position, ftk_square_e *ep)
{
  ftk_square_s     square        = board->square[position];
  ftk_board_mask_t opponent_mask = (FTK_COLOR_WHITE == square.color) ? board->black_mask : board->white_mask;

  return ftk_build_move_mask_raw(square, board->board_mask, opponent_mask, position, ep);
}

static const ftk_board_mask_t path_mask[FTK_STD_BOARD_SIZE][FTK_STD_BOARD_SIZE] = 
{
  { 0x0000000000000000, 0x0000000000000002, 0x0000000000000006, 0x000000000000000e, 0x000000000000001e, 0x000000000000003e, 0x000000000000007e, 0x00000000000000fe, 0x0000000000000100, 0x0000000000000200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000004080, 0x0000000000000000, 0x0000000000010100, 0x0000000000000000, 0x0000000000040200, 0x0000000000000000, 0x0000000000000000, 0x0000000000204080, 0x0000000000000000, 0x0000000000000000, 0x0000000001010100, 0x0000000000000000, 0x0000000000000000, 0x0000000008040200, 0x0000000010204080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000101010100, 0x0000000000000000, 0x0000000000000000, 0x0000000810204080, 0x0000001008040200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010101010100, 0x0000000000000000, 0x0000040810204080, 0x0000000000000000, 0x0000000000000000, 0x0000201008040200, 0x0000000000000000, 0x0000000000000000, 0x0001010101010100, 0x0002040810204080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040201008040200, 0x0000000000000000, 0x0101010101010100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x8142241818244280, },
  { 0x0000000000000001, 0x0000000000000000, 0x0000000000000004, 0x000000000000000c, 0x000000000000001c, 0x000000000000003c, 0x000000000000007c, 0x00000000000000fc, 0x0000000000000100, 0x0000000000000200, 0x0000000000000400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000008100, 0x0000000000000000, 0x0000000000020200, 0x0000000000000000, 0x0000000000080400, 0x0000000000000000, 0x0000000000000000, 0x0000000000408100, 0x0000000000000000, 0x0000000000000000, 0x0000000002020200, 0x0000000000000000, 0x0000000000000000, 0x0000000010080400, 0x0000000020408100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000202020200, 0x0000000000000000, 0x0000000000000000, 0x0000001020408100, 0x0000002010080400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020202020200, 0x0000000000000000, 0x0000081020408100, 0x0000000000000000, 0x0000000000000000, 0x0000402010080400, 0x0000000000000000, 0x0000000000000000, 0x0002020202020200, 0x0004081020408100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0080402010080400, 0x0000000000000000, 0x0202020202020200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000003, 0x0000000000000002, 0x0000000000000000, 0x0000000000000008, 0x0000000000000018, 0x0000000000000038, 0x0000000000000078, 0x00000000000000f8, 0x0000000000000000, 0x0000000000000200, 0x0000000000000400, 0x0000000000000800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000010200, 0x0000000000000000, 0x0000000000040400, 0x0000000000000000, 0x0000000000100800, 0x0000000000000000, 0x0000000000000000, 0x0000000000810200, 0x0000000000000000, 0x0000000000000000, 0x0000000004040400, 0x0000000000000000, 0x0000000000000000, 0x0000000020100800, 0x0000000040810200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000404040400, 0x0000000000000000, 0x0000000000000000, 0x0000002040810200, 0x0000004020100800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040404040400, 0x0000000000000000, 0x0000102040810200, 0x0000000000000000, 0x0000000000000000, 0x0000804020100800, 0x0000000000000000, 0x0000000000000000, 0x0004040404040400, 0x0008102040810200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0100804020100800, 0x0000000000000000, 0x0404040404040400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000007, 0x0000000000000006, 0x0000000000000004, 0x0000000000000000, 0x0000000000000010, 0x0000000000000030, 0x0000000000000070, 0x00000000000000f0, 0x0000000000000000, 0x0000000000000000, 0x0000000000000400, 0x0000000000000800, 0x0000000000001000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000020400, 0x0000000000000000, 0x0000000000080800, 0x0000000000000000, 0x0000000000201000, 0x0000000000000000, 0x0000000000000000, 0x0000000001020400, 0x0000000000000000, 0x0000000000000000, 0x0000000008080800, 0x0000000000000000, 0x0000000000000000, 0x0000000040201000, 0x0000000081020400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000808080800, 0x0000000000000000, 0x0000000000000000, 0x0000004081020400, 0x0000008040201000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000080808080800, 0x0000000000000000, 0x0000204081020400, 0x0000000000000000, 0x0000000000000000, 0x0001008040201000, 0x0000000000000000, 0x0000000000000000, 0x0008080808080800, 0x0010204081020400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0201008040201000, 0x0000000000000000, 0x0808080808080800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x000000000000000f, 0x000000000000000e, 0x000000000000000c, 0x0000000000000008, 0x0000000000000000, 0x0000000000000020, 0x0000000000000060, 0x00000000000000e0, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000800, 0x0000000000001000, 0x0000000000002000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000040800, 0x0000000000000000, 0x0000000000101000, 0x0000000000000000, 0x0000000000402000, 0x0000000000000000, 0x0000000000000000, 0x0000000002040800, 0x0000000000000000, 0x0000000000000000, 0x0000000010101000, 0x0000000000000000, 0x0000000000000000, 0x0000000080402000, 0x0000000102040800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000001010101000, 0x0000000000000000, 0x0000000000000000, 0x0000008102040800, 0x0000010080402000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000101010101000, 0x0000000000000000, 0x0000408102040800, 0x0000000000000000, 0x0000000000000000, 0x0002010080402000, 0x0000000000000000, 0x0000000000000000, 0x0010101010101000, 0x0020408102040800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0402010080402000, 0x0000000000000000, 0x1010101010101000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x000000000000001f, 0x000000000000001e, 0x000000000000001c, 0x0000000000000018, 0x0000000000000010, 0x0000000000000000, 0x0000000000000040, 0x00000000000000c0, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000001000, 0x0000000000002000, 0x0000000000004000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000081000, 0x0000000000000000, 0x0000000000202000, 0x0000000000000000, 0x0000000000804000, 0x0000000000000000, 0x0000000000000000, 0x0000000004081000, 0x0000000000000000, 0x0000000000000000, 0x0000000020202000, 0x0000000000000000, 0x0000000000000000, 0x0000000100804000, 0x0000000204081000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000002020202000, 0x0000000000000000, 0x0000000000000000, 0x0000010204081000, 0x0000020100804000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000202020202000, 0x0000000000000000, 0x0000810204081000, 0x0000000000000000, 0x0000000000000000, 0x0004020100804000, 0x0000000000000000, 0x0000000000000000, 0x0020202020202000, 0x0040810204081000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0804020100804000, 0x0000000000000000, 0x2020202020202000, 0x0000000000000000, 0x0000000000000000, },
  { 0x000000000000003f, 0x000000000000003e, 0x000000000000003c, 0x0000000000000038, 0x0000000000000030, 0x0000000000000020, 0x0000000000000000, 0x0000000000000080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000002000, 0x0000000000004000, 0x0000000000008000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000102000, 0x0000000000000000, 0x0000000000404000, 0x0000000000000000, 0x0000000001008000, 0x0000000000000000, 0x0000000000000000, 0x0000000008102000, 0x0000000000000000, 0x0000000000000000, 0x0000000040404000, 0x0000000000000000, 0x0000000000000000, 0x0000000201008000, 0x0000000408102000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000004040404000, 0x0000000000000000, 0x0000000000000000, 0x0000020408102000, 0x0000040201008000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000404040404000, 0x0000000000000000, 0x0001020408102000, 0x0000000000000000, 0x0000000000000000, 0x0008040201008000, 0x0000000000000000, 0x0000000000000000, 0x0040404040404000, 0x0081020408102000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x1008040201008000, 0x0000000000000000, 0x4040404040404000, 0x0000000000000000, },
  { 0x000000000000007f, 0x000000000000007e, 0x000000000000007c, 0x0000000000000078, 0x0000000000000070, 0x0000000000000060, 0x0000000000000040, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000004000, 0x0000000000008000, 0x0000000000010000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000204000, 0x0000000000000000, 0x0000000000808000, 0x0000000000000000, 0x0000000002010000, 0x0000000000000000, 0x0000000000000000, 0x0000000010204000, 0x0000000000000000, 0x0000000000000000, 0x0000000080808000, 0x0000000000000000, 0x0000000000000000, 0x0000000402010000, 0x0000000810204000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000008080808000, 0x0000000000000000, 0x0000000000000000, 0x0000040810204000, 0x0000080402010000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000808080808000, 0x0000000000000000, 0x0002040810204000, 0x0000000000000000, 0x0000000000000000, 0x0010080402010000, 0x0000000000000000, 0x0000000000000000, 0x0080808080808000, 0x0102040810204000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x2010080402010000, 0x0000000000000000, 0x8080808080808000, },
  { 0x0000000000000001, 0x0000000000000002, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000200, 0x0000000000000600, 0x0000000000000e00, 0x0000000000001e00, 0x0000000000003e00, 0x0000000000007e00, 0x000000000000fe00, 0x0000000000010000, 0x0000000000020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000408000, 0x0000000000000000, 0x0000000001010000, 0x0000000000000000, 0x0000000004020000, 0x0000000000000000, 0x0000000000000000, 0x0000000020408000, 0x0000000000000000, 0x0000000000000000, 0x0000000101010000, 0x0000000000000000, 0x0000000000000000, 0x0000000804020000, 0x0000001020408000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010101010000, 0x0000000000000000, 0x0000000000000000, 0x0000081020408000, 0x0000100804020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001010101010000, 0x0000000000000000, 0x0004081020408000, 0x0000000000000000, 0x0000000000000000, 0x0020100804020000, 0x0000000000000000, 0x0000000000000000, 0x0101010101010000, 0x0204081020408000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x4020100804020000, 0x0000000000000000, },
  { 0x0000000000000001, 0x0000000000000002, 0x0000000000000004, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000100, 0x0000000000000000, 0x0000000000000400, 0x0000000000000c00, 0x0000000000001c00, 0x0000000000003c00, 0x0000000000007c00, 0x000000000000fc00, 0x0000000000010000, 0x0000000000020000, 0x0000000000040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000810000, 0x0000000000000000, 0x0000000002020000, 0x0000000000000000, 0x0000000008040000, 0x0000000000000000, 0x0000000000000000, 0x0000000040810000, 0x0000000000000000, 0x0000000000000000, 0x0000000202020000, 0x0000000000000000, 0x0000000000000000, 0x0000001008040000, 0x0000002040810000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020202020000, 0x0000000000000000, 0x0000000000000000, 0x0000102040810000, 0x0000201008040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002020202020000, 0x0000000000000000, 0x0008102040810000, 0x0000000000000000, 0x0000000000000000, 0x0040201008040000, 0x0000000000000000, 0x0000000000000000, 0x0202020202020000, 0x0408102040810000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x8040201008040000, },
  { 0x0000000000000000, 0x0000000000000002, 0x0000000000000004, 0x0000000000000008, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000300, 0x0000000000000200, 0x0000000000000000, 0x0000000000000800, 0x0000000000001800, 0x0000000000003800, 0x0000000000007800, 0x000000000000f800, 0x0000000000000000, 0x0000000000020000, 0x0000000000040000, 0x0000000000080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000001020000, 0x0000000000000000, 0x0000000004040000, 0x0000000000000000, 0x0000000010080000, 0x0000000000000000, 0x0000000000000000, 0x0000000081020000, 0x0000000000000000, 0x0000000000000000, 0x0000000404040000, 0x0000000000000000, 0x0000000000000000, 0x0000002010080000, 0x0000004081020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040404040000, 0x0000000000000000, 0x0000000000000000, 0x0000204081020000, 0x0000402010080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004040404040000, 0x0000000000000000, 0x0010204081020000, 0x0000000000000000, 0x0000000000000000, 0x0080402010080000, 0x0000000000000000, 0x0000000000000000, 0x0404040404040000, 0x0810204081020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000004, 0x0000000000000008, 0x0000000000000010, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000700, 0x0000000000000600, 0x0000000000000400, 0x0000000000000000, 0x0000000000001000, 0x0000000000003000, 0x0000000000007000, 0x000000000000f000, 0x0000000000000000, 0x0000000000000000, 0x0000000000040000, 0x0000000000080000, 0x0000000000100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000002040000, 0x0000000000000000, 0x0000000008080000, 0x0000000000000000, 0x0000000020100000, 0x0000000000000000, 0x0000000000000000, 0x0000000102040000, 0x0000000000000000, 0x0000000000000000, 0x0000000808080000, 0x0000000000000000, 0x0000000000000000, 0x0000004020100000, 0x0000008102040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000080808080000, 0x0000000000000000, 0x0000000000000000, 0x0000408102040000, 0x0000804020100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008080808080000, 0x0000000000000000, 0x0020408102040000, 0x0000000000000000, 0x0000000000000000, 0x0100804020100000, 0x0000000000000000, 0x0000000000000000, 0x0808080808080000, 0x1020408102040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000008, 0x0000000000000010, 0x0000000000000020, 0x0000000000000000, 0x0000000000000000, 0x0000000000000f00, 0x0000000000000e00, 0x0000000000000c00, 0x0000000000000800, 0x0000000000000000, 0x0000000000002000, 0x0000000000006000, 0x000000000000e000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000080000, 0x0000000000100000, 0x0000000000200000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000004080000, 0x0000000000000000, 0x0000000010100000, 0x0000000000000000, 0x0000000040200000, 0x0000000000000000, 0x0000000000000000, 0x0000000204080000, 0x0000000000000000, 0x0000000000000000, 0x0000001010100000, 0x0000000000000000, 0x0000000000000000, 0x0000008040200000, 0x0000010204080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000101010100000, 0x0000000000000000, 0x0000000000000000, 0x0000810204080000, 0x0001008040200000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010101010100000, 0x0000000000000000, 0x0040810204080000, 0x0000000000000000, 0x0000000000000000, 0x0201008040200000, 0x0000000000000000, 0x0000000000000000, 0x1010101010100000, 0x2040810204080000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000010, 0x0000000000000020, 0x0000000000000040, 0x0000000000000000, 0x0000000000001f00, 0x0000000000001e00, 0x0000000000001c00, 0x0000000000001800, 0x0000000000001000, 0x0000000000000000, 0x0000000000004000, 0x000000000000c000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000100000, 0x0000000000200000, 0x0000000000400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000008100000, 0x0000000000000000, 0x0000000020200000, 0x0000000000000000, 0x0000000080400000, 0x0000000000000000, 0x0000000000000000, 0x0000000408100000, 0x0000000000000000, 0x0000000000000000, 0x0000002020200000, 0x0000000000000000, 0x0000000000000000, 0x0000010080400000, 0x0000020408100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000202020200000, 0x0000000000000000, 0x0000000000000000, 0x0001020408100000, 0x0002010080400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020202020200000, 0x0000000000000000, 0x0081020408100000, 0x0000000000000000, 0x0000000000000000, 0x0402010080400000, 0x0000000000000000, 0x0000000000000000, 0x2020202020200000, 0x4081020408100000, 0x0000000000000000, },
  { 0x0000000000000081, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000020, 0x0000000000000040, 0x0000000000000080, 0x0000000000003f00, 0x0000000000003e00, 0x0000000000003c00, 0x0000000000003800, 0x0000000000003000, 0x0000000000002000, 0x0000000000000000, 0x0000000000008000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000200000, 0x0000000000400000, 0x0000000000800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000010200000, 0x0000000000000000, 0x0000000040400000, 0x0000000000000000, 0x0000000100800000, 0x0000000000000000, 0x0000000000000000, 0x0000000810200000, 0x0000000000000000, 0x0000000000000000, 0x0000004040400000, 0x0000000000000000, 0x0000000000000000, 0x0000020100800000, 0x0000040810200000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000404040400000, 0x0000000000000000, 0x0000000000000000, 0x0002040810200000, 0x0004020100800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040404040400000, 0x0000000000000000, 0x0102040810200000, 0x0000000000000000, 0x0000000000000000, 0x0804020100800000, 0x0000000000000000, 0x0000000000000000, 0x4040404040400000, 0x8102040810200000, },
  { 0x0000000000000000, 0x0000000000000102, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000040, 0x0000000000000080, 0x0000000000007f00, 0x0000000000007e00, 0x0000000000007c00, 0x0000000000007800, 0x0000000000007000, 0x0000000000006000, 0x0000000000004000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000400000, 0x0000000000800000, 0x0000000001000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000020400000, 0x0000000000000000, 0x0000000080800000, 0x0000000000000000, 0x0000000201000000, 0x0000000000000000, 0x0000000000000000, 0x0000001020400000, 0x0000000000000000, 0x0000000000000000, 0x0000008080800000, 0x0000000000000000, 0x0000000000000000, 0x0000040201000000, 0x0000081020400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000808080800000, 0x0000000000000000, 0x0000000000000000, 0x0004081020400000, 0x0008040201000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0080808080800000, 0x0000000000000000, 0x0204081020400000, 0x0000000000000000, 0x0000000000000000, 0x1008040201000000, 0x0000000000000000, 0x0000000000000000, 0x8080808080800000, },
  { 0x0000000000000101, 0x0000000000000000, 0x0000000000000204, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000080, 0x0000000000000100, 0x0000000000000200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000020000, 0x0000000000060000, 0x00000000000e0000, 0x00000000001e0000, 0x00000000003e0000, 0x00000000007e0000, 0x0000000000fe0000, 0x0000000001000000, 0x0000000002000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000040800000, 0x0000000000000000, 0x0000000101000000, 0x0000000000000000, 0x0000000402000000, 0x0000000000000000, 0x0000000000000000, 0x0000002040800000, 0x0000000000000000, 0x0000000000000000, 0x0000010101000000, 0x0000000000000000, 0x0000000000000000, 0x0000080402000000, 0x0000102040800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001010101000000, 0x0000000000000000, 0x0000000000000000, 0x0008102040800000, 0x0010080402000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0101010101000000, 0x0000000000000000, 0x0408102040800000, 0x0000000000000000, 0x0000000000000000, 0x2010080402000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000202, 0x0000000000000000, 0x0000000000000408, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000100, 0x0000000000000200, 0x0000000000000400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000010000, 0x0000000000000000, 0x0000000000040000, 0x00000000000c0000, 0x00000000001c0000, 0x00000000003c0000, 0x00000000007c0000, 0x0000000000fc0000, 0x0000000001000000, 0x0000000002000000, 0x0000000004000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000081000000, 0x0000000000000000, 0x0000000202000000, 0x0000000000000000, 0x0000000804000000, 0x0000000000000000, 0x0000000000000000, 0x0000004081000000, 0x0000000000000000, 0x0000000000000000, 0x0000020202000000, 0x0000000000000000, 0x0000000000000000, 0x0000100804000000, 0x0000204081000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002020202000000, 0x0000000000000000, 0x0000000000000000, 0x0010204081000000, 0x0020100804000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0202020202000000, 0x0000000000000000, 0x0810204081000000, 0x0000000000000000, 0x0000000000000000, 0x4020100804000000, 0x0000000000000000, },
  { 0x0000000000000201, 0x0000000000000000, 0x0000000000000404, 0x0000000000000000, 0x0000000000000810, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000200, 0x0000000000000400, 0x0000000000000800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000030000, 0x0000000000020000, 0x0000000000000000, 0x0000000000080000, 0x0000000000180000, 0x0000000000380000, 0x0000000000780000, 0x0000000000f80000, 0x0000000000000000, 0x0000000002000000, 0x0000000004000000, 0x0000000008000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000102000000, 0x0000000000000000, 0x0000000404000000, 0x0000000000000000, 0x0000001008000000, 0x0000000000000000, 0x0000000000000000, 0x0000008102000000, 0x0000000000000000, 0x0000000000000000, 0x0000040404000000, 0x0000000000000000, 0x0000000000000000, 0x0000201008000000, 0x0000408102000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004040404000000, 0x0000000000000000, 0x0000000000000000, 0x0020408102000000, 0x0040201008000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0404040404000000, 0x0000000000000000, 0x1020408102000000, 0x0000000000000000, 0x0000000000000000, 0x8040201008000000, },
  { 0x0000000000000000, 0x0000000000000402, 0x0000000000000000, 0x0000000000000808, 0x0000000000000000, 0x0000000000001020, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000400, 0x0000000000000800, 0x0000000000001000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000070000, 0x0000000000060000, 0x0000000000040000, 0x0000000000000000, 0x0000000000100000, 0x0000000000300000, 0x0000000000700000, 0x0000000000f00000, 0x0000000000000000, 0x0000000000000000, 0x0000000004000000, 0x0000000008000000, 0x0000000010000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000204000000, 0x0000000000000000, 0x0000000808000000, 0x0000000000000000, 0x0000002010000000, 0x0000000000000000, 0x0000000000000000, 0x0000010204000000, 0x0000000000000000, 0x0000000000000000, 0x0000080808000000, 0x0000000000000000, 0x0000000000000000, 0x0000402010000000, 0x0000810204000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008080808000000, 0x0000000000000000, 0x0000000000000000, 0x0040810204000000, 0x0080402010000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0808080808000000, 0x0000000000000000, 0x2040810204000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000804, 0x0000000000000000, 0x0000000000001010, 0x0000000000000000, 0x0000000000002040, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000800, 0x0000000000001000, 0x0000000000002000, 0x0000000000000000, 0x0000000000000000, 0x00000000000f0000, 0x00000000000e0000, 0x00000000000c0000, 0x0000000000080000, 0x0000000000000000, 0x0000000000200000, 0x0000000000600000, 0x0000000000e00000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000008000000, 0x0000000010000000, 0x0000000020000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000408000000, 0x0000000000000000, 0x0000001010000000, 0x0000000000000000, 0x0000004020000000, 0x0000000000000000, 0x0000000000000000, 0x0000020408000000, 0x0000000000000000, 0x0000000000000000, 0x0000101010000000, 0x0000000000000000, 0x0000000000000000, 0x0000804020000000, 0x0001020408000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010101010000000, 0x0000000000000000, 0x0000000000000000, 0x0081020408000000, 0x0100804020000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x1010101010000000, 0x0000000000000000, 0x4081020408000000, 0x0000000000000000, },
  { 0x0000000000004081, 0x0000000000000000, 0x0000000000000000, 0x0000000000001008, 0x0000000000000000, 0x0000000000002020, 0x0000000000000000, 0x0000000000004080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000001000, 0x0000000000002000, 0x0000000000004000, 0x0000000000000000, 0x00000000001f0000, 0x00000000001e0000, 0x00000000001c0000, 0x0000000000180000, 0x0000000000100000, 0x0000000000000000, 0x0000000000400000, 0x0000000000c00000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000010000000, 0x0000000020000000, 0x0000000040000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000810000000, 0x0000000000000000, 0x0000002020000000, 0x0000000000000000, 0x0000008040000000, 0x0000000000000000, 0x0000000000000000, 0x0000040810000000, 0x0000000000000000, 0x0000000000000000, 0x0000202020000000, 0x0000000000000000, 0x0000000000000000, 0x0001008040000000, 0x0002040810000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020202020000000, 0x0000000000000000, 0x0000000000000000, 0x0102040810000000, 0x0201008040000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x2020202020000000, 0x0000000000000000, 0x8102040810000000, },
  { 0x0000000000000000, 0x0000000000008102, 0x0000000000000000, 0x0000000000000000, 0x0000000000002010, 0x0000000000000000, 0x0000000000004040, 0x0000000000000000, 0x0000000000008100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000002000, 0x0000000000004000, 0x0000000000008000, 0x00000000003f0000, 0x00000000003e0000, 0x00000000003c0000, 0x0000000000380000, 0x0000000000300000, 0x0000000000200000, 0x0000000000000000, 0x0000000000800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000020000000, 0x0000000040000000, 0x0000000080000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000001020000000, 0x0000000000000000, 0x0000004040000000, 0x0000000000000000, 0x0000010080000000, 0x0000000000000000, 0x0000000000000000, 0x0000081020000000, 0x0000000000000000, 0x0000000000000000, 0x0000404040000000, 0x0000000000000000, 0x0000000000000000, 0x0002010080000000, 0x0004081020000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040404040000000, 0x0000000000000000, 0x0000000000000000, 0x0204081020000000, 0x0402010080000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x4040404040000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000010204, 0x0000000000000000, 0x0000000000000000, 0x0000000000004020, 0x0000000000000000, 0x0000000000008080, 0x0000000000000000, 0x0000000000010200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000004000, 0x0000000000008000, 0x00000000007f0000, 0x00000000007e0000, 0x00000000007c0000, 0x0000000000780000, 0x0000000000700000, 0x0000000000600000, 0x0000000000400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000040000000, 0x0000000080000000, 0x0000000100000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000002040000000, 0x0000000000000000, 0x0000008080000000, 0x0000000000000000, 0x0000020100000000, 0x0000000000000000, 0x0000000000000000, 0x0000102040000000, 0x0000000000000000, 0x0000000000000000, 0x0000808080000000, 0x0000000000000000, 0x0000000000000000, 0x0004020100000000, 0x0008102040000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0080808080000000, 0x0000000000000000, 0x0000000000000000, 0x0408102040000000, 0x0804020100000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x8080808080000000, },
  { 0x0000000000010101, 0x0000000000000000, 0x0000000000000000, 0x0000000000020408, 0x0000000000000000, 0x0000000000000000, 0x0000000000008040, 0x0000000000000000, 0x0000000000010100, 0x0000000000000000, 0x0000000000020400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000008000, 0x0000000000010000, 0x0000000000020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000002000000, 0x0000000006000000, 0x000000000e000000, 0x000000001e000000, 0x000000003e000000, 0x000000007e000000, 0x00000000fe000000, 0x0000000100000000, 0x0000000200000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000004080000000, 0x0000000000000000, 0x0000010100000000, 0x0000000000000000, 0x0000040200000000, 0x0000000000000000, 0x0000000000000000, 0x0000204080000000, 0x0000000000000000, 0x0000000000000000, 0x0001010100000000, 0x0000000000000000, 0x0000000000000000, 0x0008040200000000, 0x0010204080000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0101010100000000, 0x0000000000000000, 0x0000000000000000, 0x0810204080000000, 0x1008040200000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000020202, 0x0000000000000000, 0x0000000000000000, 0x0000000000040810, 0x0000000000000000, 0x0000000000000000, 0x0000000000010080, 0x0000000000000000, 0x0000000000020200, 0x0000000000000000, 0x0000000000040800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000010000, 0x0000000000020000, 0x0000000000040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000001000000, 0x0000000000000000, 0x0000000004000000, 0x000000000c000000, 0x000000001c000000, 0x000000003c000000, 0x000000007c000000, 0x00000000fc000000, 0x0000000100000000, 0x0000000200000000, 0x0000000400000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000008100000000, 0x0000000000000000, 0x0000020200000000, 0x0000000000000000, 0x0000080400000000, 0x0000000000000000, 0x0000000000000000, 0x0000408100000000, 0x0000000000000000, 0x0000000000000000, 0x0002020200000000, 0x0000000000000000, 0x0000000000000000, 0x0010080400000000, 0x0020408100000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0202020200000000, 0x0000000000000000, 0x0000000000000000, 0x1020408100000000, 0x2010080400000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000040404, 0x0000000000000000, 0x0000000000000000, 0x0000000000081020, 0x0000000000000000, 0x0000000000000000, 0x0000000000020100, 0x0000000000000000, 0x0000000000040400, 0x0000000000000000, 0x0000000000081000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000020000, 0x0000000000040000, 0x0000000000080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000003000000, 0x0000000002000000, 0x0000000000000000, 0x0000000008000000, 0x0000000018000000, 0x0000000038000000, 0x0000000078000000, 0x00000000f8000000, 0x0000000000000000, 0x0000000200000000, 0x0000000400000000, 0x0000000800000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010200000000, 0x0000000000000000, 0x0000040400000000, 0x0000000000000000, 0x0000100800000000, 0x0000000000000000, 0x0000000000000000, 0x0000810200000000, 0x0000000000000000, 0x0000000000000000, 0x0004040400000000, 0x0000000000000000, 0x0000000000000000, 0x0020100800000000, 0x0040810200000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0404040400000000, 0x0000000000000000, 0x0000000000000000, 0x2040810200000000, 0x4020100800000000, 0x0000000000000000, },
  { 0x0000000000040201, 0x0000000000000000, 0x0000000000000000, 0x0000000000080808, 0x0000000000000000, 0x0000000000000000, 0x0000000000102040, 0x0000000000000000, 0x0000000000000000, 0x0000000000040200, 0x0000000000000000, 0x0000000000080800, 0x0000000000000000, 0x0000000000102000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000040000, 0x0000000000080000, 0x0000000000100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000007000000, 0x0000000006000000, 0x0000000004000000, 0x0000000000000000, 0x0000000010000000, 0x0000000030000000, 0x0000000070000000, 0x00000000f0000000, 0x0000000000000000, 0x0000000000000000, 0x0000000400000000, 0x0000000800000000, 0x0000001000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020400000000, 0x0000000000000000, 0x0000080800000000, 0x0000000000000000, 0x0000201000000000, 0x0000000000000000, 0x0000000000000000, 0x0001020400000000, 0x0000000000000000, 0x0000000000000000, 0x0008080800000000, 0x0000000000000000, 0x0000000000000000, 0x0040201000000000, 0x0081020400000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0808080800000000, 0x0000000000000000, 0x0000000000000000, 0x4081020400000000, 0x8040201000000000, },
  { 0x0000000000204081, 0x0000000000080402, 0x0000000000000000, 0x0000000000000000, 0x0000000000101010, 0x0000000000000000, 0x0000000000000000, 0x0000000000204080, 0x0000000000000000, 0x0000000000000000, 0x0000000000080400, 0x0000000000000000, 0x0000000000101000, 0x0000000000000000, 0x0000000000204000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000080000, 0x0000000000100000, 0x0000000000200000, 0x0000000000000000, 0x0000000000000000, 0x000000000f000000, 0x000000000e000000, 0x000000000c000000, 0x0000000008000000, 0x0000000000000000, 0x0000000020000000, 0x0000000060000000, 0x00000000e0000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000800000000, 0x0000001000000000, 0x0000002000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040800000000, 0x0000000000000000, 0x0000101000000000, 0x0000000000000000, 0x0000402000000000, 0x0000000000000000, 0x0000000000000000, 0x0002040800000000, 0x0000000000000000, 0x0000000000000000, 0x0010101000000000, 0x0000000000000000, 0x0000000000000000, 0x0080402000000000, 0x0102040800000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x1010101000000000, 0x0000000000000000, 0x0000000000000000, 0x8102040800000000, },
  { 0x0000000000000000, 0x0000000000408102, 0x0000000000100804, 0x0000000000000000, 0x0000000000000000, 0x0000000000202020, 0x0000000000000000, 0x0000000000000000, 0x0000000000408100, 0x0000000000000000, 0x0000000000000000, 0x0000000000100800, 0x0000000000000000, 0x0000000000202000, 0x0000000000000000, 0x0000000000408000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000100000, 0x0000000000200000, 0x0000000000400000, 0x0000000000000000, 0x000000001f000000, 0x000000001e000000, 0x000000001c000000, 0x0000000018000000, 0x0000000010000000, 0x0000000000000000, 0x0000000040000000, 0x00000000c0000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000001000000000, 0x0000002000000000, 0x0000004000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000081000000000, 0x0000000000000000, 0x0000202000000000, 0x0000000000000000, 0x0000804000000000, 0x0000000000000000, 0x0000000000000000, 0x0004081000000000, 0x0000000000000000, 0x0000000000000000, 0x0020202000000000, 0x0000000000000000, 0x0000000000000000, 0x0100804000000000, 0x0204081000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x2020202000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000810204, 0x0000000000201008, 0x0000000000000000, 0x0000000000000000, 0x0000000000404040, 0x0000000000000000, 0x0000000000000000, 0x0000000000810200, 0x0000000000000000, 0x0000000000000000, 0x0000000000201000, 0x0000000000000000, 0x0000000000404000, 0x0000000000000000, 0x0000000000810000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000200000, 0x0000000000400000, 0x0000000000800000, 0x000000003f000000, 0x000000003e000000, 0x000000003c000000, 0x0000000038000000, 0x0000000030000000, 0x0000000020000000, 0x0000000000000000, 0x0000000080000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000002000000000, 0x0000004000000000, 0x0000008000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000102000000000, 0x0000000000000000, 0x0000404000000000, 0x0000000000000000, 0x0001008000000000, 0x0000000000000000, 0x0000000000000000, 0x0008102000000000, 0x0000000000000000, 0x0000000000000000, 0x0040404000000000, 0x0000000000000000, 0x0000000000000000, 0x0201008000000000, 0x0408102000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x4040404000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000001020408, 0x0000000000402010, 0x0000000000000000, 0x0000000000000000, 0x0000000000808080, 0x0000000000000000, 0x0000000000000000, 0x0000000001020400, 0x0000000000000000, 0x0000000000000000, 0x0000000000402000, 0x0000000000000000, 0x0000000000808000, 0x0000000000000000, 0x0000000001020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000400000, 0x0000000000800000, 0x000000007f000000, 0x000000007e000000, 0x000000007c000000, 0x0000000078000000, 0x0000000070000000, 0x0000000060000000, 0x0000000040000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000004000000000, 0x0000008000000000, 0x0000010000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000204000000000, 0x0000000000000000, 0x0000808000000000, 0x0000000000000000, 0x0002010000000000, 0x0000000000000000, 0x0000000000000000, 0x0010204000000000, 0x0000000000000000, 0x0000000000000000, 0x0080808000000000, 0x0000000000000000, 0x0000000000000000, 0x0402010000000000, 0x0810204000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x8080808000000000, },
  { 0x0000000001010101, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000002040810, 0x0000000000804020, 0x0000000000000000, 0x0000000000000000, 0x0000000001010100, 0x0000000000000000, 0x0000000000000000, 0x0000000002040800, 0x0000000000000000, 0x0000000000000000, 0x0000000000804000, 0x0000000000000000, 0x0000000001010000, 0x0000000000000000, 0x0000000002040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000800000, 0x0000000001000000, 0x0000000002000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000200000000, 0x0000000600000000, 0x0000000e00000000, 0x0000001e00000000, 0x0000003e00000000, 0x0000007e00000000, 0x000000fe00000000, 0x0000010000000000, 0x0000020000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000408000000000, 0x0000000000000000, 0x0001010000000000, 0x0000000000000000, 0x0004020000000000, 0x0000000000000000, 0x0000000000000000, 0x0020408000000000, 0x0000000000000000, 0x0000000000000000, 0x0101010000000000, 0x0000000000000000, 0x0000000000000000, 0x0804020000000000, 0x1020408000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000002020202, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000004081020, 0x0000000001008040, 0x0000000000000000, 0x0000000000000000, 0x0000000002020200, 0x0000000000000000, 0x0000000000000000, 0x0000000004081000, 0x0000000000000000, 0x0000000000000000, 0x0000000001008000, 0x0000000000000000, 0x0000000002020000, 0x0000000000000000, 0x0000000004080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000001000000, 0x0000000002000000, 0x0000000004000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000100000000, 0x0000000000000000, 0x0000000400000000, 0x0000000c00000000, 0x0000001c00000000, 0x0000003c00000000, 0x0000007c00000000, 0x000000fc00000000, 0x0000010000000000, 0x0000020000000000, 0x0000040000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000810000000000, 0x0000000000000000, 0x0002020000000000, 0x0000000000000000, 0x0008040000000000, 0x0000000000000000, 0x0000000000000000, 0x0040810000000000, 0x0000000000000000, 0x0000000000000000, 0x0202020000000000, 0x0000000000000000, 0x0000000000000000, 0x1008040000000000, 0x2040810000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000004040404, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000008102040, 0x0000000002010080, 0x0000000000000000, 0x0000000000000000, 0x0000000004040400, 0x0000000000000000, 0x0000000000000000, 0x0000000008102000, 0x0000000000000000, 0x0000000000000000, 0x0000000002010000, 0x0000000000000000, 0x0000000004040000, 0x0000000000000000, 0x0000000008100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000002000000, 0x0000000004000000, 0x0000000008000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000300000000, 0x0000000200000000, 0x0000000000000000, 0x0000000800000000, 0x0000001800000000, 0x0000003800000000, 0x0000007800000000, 0x000000f800000000, 0x0000000000000000, 0x0000020000000000, 0x0000040000000000, 0x0000080000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001020000000000, 0x0000000000000000, 0x0004040000000000, 0x0000000000000000, 0x0010080000000000, 0x0000000000000000, 0x0000000000000000, 0x0081020000000000, 0x0000000000000000, 0x0000000000000000, 0x0404040000000000, 0x0000000000000000, 0x0000000000000000, 0x2010080000000000, 0x4081020000000000, 0x0000000000000000, },
  { 0x0000000010204081, 0x0000000000000000, 0x0000000000000000, 0x0000000008080808, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000010204080, 0x0000000004020100, 0x0000000000000000, 0x0000000000000000, 0x0000000008080800, 0x0000000000000000, 0x0000000000000000, 0x0000000010204000, 0x0000000000000000, 0x0000000000000000, 0x0000000004020000, 0x0000000000000000, 0x0000000008080000, 0x0000000000000000, 0x0000000010200000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000004000000, 0x0000000008000000, 0x0000000010000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000700000000, 0x0000000600000000, 0x0000000400000000, 0x0000000000000000, 0x0000001000000000, 0x0000003000000000, 0x0000007000000000, 0x000000f000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040000000000, 0x0000080000000000, 0x0000100000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002040000000000, 0x0000000000000000, 0x0008080000000000, 0x0000000000000000, 0x0020100000000000, 0x0000000000000000, 0x0000000000000000, 0x0102040000000000, 0x0000000000000000, 0x0000000000000000, 0x0808080000000000, 0x0000000000000000, 0x0000000000000000, 0x4020100000000000, 0x8102040000000000, },
  { 0x0000000008040201, 0x0000000020408102, 0x0000000000000000, 0x0000000000000000, 0x0000000010101010, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000020408100, 0x0000000008040200, 0x0000000000000000, 0x0000000000000000, 0x0000000010101000, 0x0000000000000000, 0x0000000000000000, 0x0000000020408000, 0x0000000000000000, 0x0000000000000000, 0x0000000008040000, 0x0000000000000000, 0x0000000010100000, 0x0000000000000000, 0x0000000020400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000008000000, 0x0000000010000000, 0x0000000020000000, 0x0000000000000000, 0x0000000000000000, 0x0000000f00000000, 0x0000000e00000000, 0x0000000c00000000, 0x0000000800000000, 0x0000000000000000, 0x0000002000000000, 0x0000006000000000, 0x000000e000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000080000000000, 0x0000100000000000, 0x0000200000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004080000000000, 0x0000000000000000, 0x0010100000000000, 0x0000000000000000, 0x0040200000000000, 0x0000000000000000, 0x0000000000000000, 0x0204080000000000, 0x0000000000000000, 0x0000000000000000, 0x1010100000000000, 0x0000000000000000, 0x0000000000000000, 0x8040200000000000, },
  { 0x0000000000000000, 0x0000000010080402, 0x0000000040810204, 0x0000000000000000, 0x0000000000000000, 0x0000000020202020, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000040810200, 0x0000000010080400, 0x0000000000000000, 0x0000000000000000, 0x0000000020202000, 0x0000000000000000, 0x0000000000000000, 0x0000000040810000, 0x0000000000000000, 0x0000000000000000, 0x0000000010080000, 0x0000000000000000, 0x0000000020200000, 0x0000000000000000, 0x0000000040800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000010000000, 0x0000000020000000, 0x0000000040000000, 0x0000000000000000, 0x0000001f00000000, 0x0000001e00000000, 0x0000001c00000000, 0x0000001800000000, 0x0000001000000000, 0x0000000000000000, 0x0000004000000000, 0x000000c000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000100000000000, 0x0000200000000000, 0x0000400000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008100000000000, 0x0000000000000000, 0x0020200000000000, 0x0000000000000000, 0x0080400000000000, 0x0000000000000000, 0x0000000000000000, 0x0408100000000000, 0x0000000000000000, 0x0000000000000000, 0x2020200000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000020100804, 0x0000000081020408, 0x0000000000000000, 0x0000000000000000, 0x0000000040404040, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000081020400, 0x0000000020100800, 0x0000000000000000, 0x0000000000000000, 0x0000000040404000, 0x0000000000000000, 0x0000000000000000, 0x0000000081020000, 0x0000000000000000, 0x0000000000000000, 0x0000000020100000, 0x0000000000000000, 0x0000000040400000, 0x0000000000000000, 0x0000000081000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000020000000, 0x0000000040000000, 0x0000000080000000, 0x0000003f00000000, 0x0000003e00000000, 0x0000003c00000000, 0x0000003800000000, 0x0000003000000000, 0x0000002000000000, 0x0000000000000000, 0x0000008000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000200000000000, 0x0000400000000000, 0x0000800000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010200000000000, 0x0000000000000000, 0x0040400000000000, 0x0000000000000000, 0x0100800000000000, 0x0000000000000000, 0x0000000000000000, 0x0810200000000000, 0x0000000000000000, 0x0000000000000000, 0x4040400000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000040201008, 0x0000000102040810, 0x0000000000000000, 0x0000000000000000, 0x0000000080808080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000102040800, 0x0000000040201000, 0x0000000000000000, 0x0000000000000000, 0x0000000080808000, 0x0000000000000000, 0x0000000000000000, 0x0000000102040000, 0x0000000000000000, 0x0000000000000000, 0x0000000040200000, 0x0000000000000000, 0x0000000080800000, 0x0000000000000000, 0x0000000102000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000040000000, 0x0000000080000000, 0x0000007f00000000, 0x0000007e00000000, 0x0000007c00000000, 0x0000007800000000, 0x0000007000000000, 0x0000006000000000, 0x0000004000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000400000000000, 0x0000800000000000, 0x0001000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020400000000000, 0x0000000000000000, 0x0080800000000000, 0x0000000000000000, 0x0201000000000000, 0x0000000000000000, 0x0000000000000000, 0x1020400000000000, 0x0000000000000000, 0x0000000000000000, 0x8080800000000000, },
  { 0x0000000101010101, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000080402010, 0x0000000204081020, 0x0000000000000000, 0x0000000000000000, 0x0000000101010100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000204081000, 0x0000000080402000, 0x0000000000000000, 0x0000000000000000, 0x0000000101010000, 0x0000000000000000, 0x0000000000000000, 0x0000000204080000, 0x0000000000000000, 0x0000000000000000, 0x0000000080400000, 0x0000000000000000, 0x0000000101000000, 0x0000000000000000, 0x0000000204000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000080000000, 0x0000000100000000, 0x0000000200000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020000000000, 0x0000060000000000, 0x00000e0000000000, 0x00001e0000000000, 0x00003e0000000000, 0x00007e0000000000, 0x0000fe0000000000, 0x0001000000000000, 0x0002000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040800000000000, 0x0000000000000000, 0x0101000000000000, 0x0000000000000000, 0x0402000000000000, 0x0000000000000000, 0x0000000000000000, 0x2040800000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000202020202, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000100804020, 0x0000000408102040, 0x0000000000000000, 0x0000000000000000, 0x0000000202020200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000408102000, 0x0000000100804000, 0x0000000000000000, 0x0000000000000000, 0x0000000202020000, 0x0000000000000000, 0x0000000000000000, 0x0000000408100000, 0x0000000000000000, 0x0000000000000000, 0x0000000100800000, 0x0000000000000000, 0x0000000202000000, 0x0000000000000000, 0x0000000408000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000100000000, 0x0000000200000000, 0x0000000400000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010000000000, 0x0000000000000000, 0x0000040000000000, 0x00000c0000000000, 0x00001c0000000000, 0x00003c0000000000, 0x00007c0000000000, 0x0000fc0000000000, 0x0001000000000000, 0x0002000000000000, 0x0004000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0081000000000000, 0x0000000000000000, 0x0202000000000000, 0x0000000000000000, 0x0804000000000000, 0x0000000000000000, 0x0000000000000000, 0x4081000000000000, 0x0000000000000000, },
  { 0x0000000810204081, 0x0000000000000000, 0x0000000404040404, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000201008040, 0x0000000810204080, 0x0000000000000000, 0x0000000000000000, 0x0000000404040400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000810204000, 0x0000000201008000, 0x0000000000000000, 0x0000000000000000, 0x0000000404040000, 0x0000000000000000, 0x0000000000000000, 0x0000000810200000, 0x0000000000000000, 0x0000000000000000, 0x0000000201000000, 0x0000000000000000, 0x0000000404000000, 0x0000000000000000, 0x0000000810000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000200000000, 0x0000000400000000, 0x0000000800000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000030000000000, 0x0000020000000000, 0x0000000000000000, 0x0000080000000000, 0x0000180000000000, 0x0000380000000000, 0x0000780000000000, 0x0000f80000000000, 0x0000000000000000, 0x0002000000000000, 0x0004000000000000, 0x0008000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0102000000000000, 0x0000000000000000, 0x0404000000000000, 0x0000000000000000, 0x1008000000000000, 0x0000000000000000, 0x0000000000000000, 0x8102000000000000, },
  { 0x0000000000000000, 0x0000001020408102, 0x0000000000000000, 0x0000000808080808, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000402010080, 0x0000001020408100, 0x0000000000000000, 0x0000000000000000, 0x0000000808080800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000001020408000, 0x0000000402010000, 0x0000000000000000, 0x0000000000000000, 0x0000000808080000, 0x0000000000000000, 0x0000000000000000, 0x0000001020400000, 0x0000000000000000, 0x0000000000000000, 0x0000000402000000, 0x0000000000000000, 0x0000000808000000, 0x0000000000000000, 0x0000001020000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000400000000, 0x0000000800000000, 0x0000001000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000070000000000, 0x0000060000000000, 0x0000040000000000, 0x0000000000000000, 0x0000100000000000, 0x0000300000000000, 0x0000700000000000, 0x0000f00000000000, 0x0000000000000000, 0x0000000000000000, 0x0004000000000000, 0x0008000000000000, 0x0010000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0204000000000000, 0x0000000000000000, 0x0808000000000000, 0x0000000000000000, 0x2010000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000002040810204, 0x0000000000000000, 0x0000001010101010, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000804020100, 0x0000002040810200, 0x0000000000000000, 0x0000000000000000, 0x0000001010101000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000002040810000, 0x0000000804020000, 0x0000000000000000, 0x0000000000000000, 0x0000001010100000, 0x0000000000000000, 0x0000000000000000, 0x0000002040800000, 0x0000000000000000, 0x0000000000000000, 0x0000000804000000, 0x0000000000000000, 0x0000001010000000, 0x0000000000000000, 0x0000002040000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000800000000, 0x0000001000000000, 0x0000002000000000, 0x0000000000000000, 0x0000000000000000, 0x00000f0000000000, 0x00000e0000000000, 0x00000c0000000000, 0x0000080000000000, 0x0000000000000000, 0x0000200000000000, 0x0000600000000000, 0x0000e00000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008000000000000, 0x0010000000000000, 0x0020000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0408000000000000, 0x0000000000000000, 0x1010000000000000, 0x0000000000000000, 0x4020000000000000, 0x0000000000000000, },
  { 0x0000001008040201, 0x0000000000000000, 0x0000000000000000, 0x0000004081020408, 0x0000000000000000, 0x0000002020202020, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000001008040200, 0x0000004081020400, 0x0000000000000000, 0x0000000000000000, 0x0000002020202000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000004081020000, 0x0000001008040000, 0x0000000000000000, 0x0000000000000000, 0x0000002020200000, 0x0000000000000000, 0x0000000000000000, 0x0000004081000000, 0x0000000000000000, 0x0000000000000000, 0x0000001008000000, 0x0000000000000000, 0x0000002020000000, 0x0000000000000000, 0x0000004080000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000001000000000, 0x0000002000000000, 0x0000004000000000, 0x0000000000000000, 0x00001f0000000000, 0x00001e0000000000, 0x00001c0000000000, 0x0000180000000000, 0x0000100000000000, 0x0000000000000000, 0x0000400000000000, 0x0000c00000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010000000000000, 0x0020000000000000, 0x0040000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0810000000000000, 0x0000000000000000, 0x2020000000000000, 0x0000000000000000, 0x8040000000000000, },
  { 0x0000000000000000, 0x0000002010080402, 0x0000000000000000, 0x0000000000000000, 0x0000008102040810, 0x0000000000000000, 0x0000004040404040, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000002010080400, 0x0000008102040800, 0x0000000000000000, 0x0000000000000000, 0x0000004040404000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000008102040000, 0x0000002010080000, 0x0000000000000000, 0x0000000000000000, 0x0000004040400000, 0x0000000000000000, 0x0000000000000000, 0x0000008102000000, 0x0000000000000000, 0x0000000000000000, 0x0000002010000000, 0x0000000000000000, 0x0000004040000000, 0x0000000000000000, 0x0000008100000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000002000000000, 0x0000004000000000, 0x0000008000000000, 0x00003f0000000000, 0x00003e0000000000, 0x00003c0000000000, 0x0000380000000000, 0x0000300000000000, 0x0000200000000000, 0x0000000000000000, 0x0000800000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020000000000000, 0x0040000000000000, 0x0080000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x1020000000000000, 0x0000000000000000, 0x4040000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000004020100804, 0x0000000000000000, 0x0000000000000000, 0x0000010204081020, 0x0000000000000000, 0x0000008080808080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000004020100800, 0x0000010204081000, 0x0000000000000000, 0x0000000000000000, 0x0000008080808000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010204080000, 0x0000004020100000, 0x0000000000000000, 0x0000000000000000, 0x0000008080800000, 0x0000000000000000, 0x0000000000000000, 0x0000010204000000, 0x0000000000000000, 0x0000000000000000, 0x0000004020000000, 0x0000000000000000, 0x0000008080000000, 0x0000000000000000, 0x0000010200000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000004000000000, 0x0000008000000000, 0x00007f0000000000, 0x00007e0000000000, 0x00007c0000000000, 0x0000780000000000, 0x0000700000000000, 0x0000600000000000, 0x0000400000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040000000000000, 0x0080000000000000, 0x0100000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x2040000000000000, 0x0000000000000000, 0x8080000000000000, },
  { 0x0000010101010101, 0x0000000000000000, 0x0000000000000000, 0x0000008040201008, 0x0000000000000000, 0x0000000000000000, 0x0000020408102040, 0x0000000000000000, 0x0000010101010100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000008040201000, 0x0000020408102000, 0x0000000000000000, 0x0000000000000000, 0x0000010101010000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020408100000, 0x0000008040200000, 0x0000000000000000, 0x0000000000000000, 0x0000010101000000, 0x0000000000000000, 0x0000000000000000, 0x0000020408000000, 0x0000000000000000, 0x0000000000000000, 0x0000008040000000, 0x0000000000000000, 0x0000010100000000, 0x0000000000000000, 0x0000020400000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000008000000000, 0x0000010000000000, 0x0000020000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002000000000000, 0x0006000000000000, 0x000e000000000000, 0x001e000000000000, 0x003e000000000000, 0x007e000000000000, 0x00fe000000000000, 0x0100000000000000, 0x0200000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x4080000000000000, 0x0000000000000000, },
  { 0x0000040810204081, 0x0000020202020202, 0x0000000000000000, 0x0000000000000000, 0x0000010080402010, 0x0000000000000000, 0x0000000000000000, 0x0000040810204080, 0x0000000000000000, 0x0000020202020200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010080402000, 0x0000040810204000, 0x0000000000000000, 0x0000000000000000, 0x0000020202020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040810200000, 0x0000010080400000, 0x0000000000000000, 0x0000000000000000, 0x0000020202000000, 0x0000000000000000, 0x0000000000000000, 0x0000040810000000, 0x0000000000000000, 0x0000000000000000, 0x0000010080000000, 0x0000000000000000, 0x0000020200000000, 0x0000000000000000, 0x0000040800000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000010000000000, 0x0000020000000000, 0x0000040000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001000000000000, 0x0000000000000000, 0x0004000000000000, 0x000c000000000000, 0x001c000000000000, 0x003c000000000000, 0x007c000000000000, 0x00fc000000000000, 0x0100000000000000, 0x0200000000000000, 0x0400000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x8100000000000000, },
  { 0x0000000000000000, 0x0000081020408102, 0x0000040404040404, 0x0000000000000000, 0x0000000000000000, 0x0000020100804020, 0x0000000000000000, 0x0000000000000000, 0x0000081020408100, 0x0000000000000000, 0x0000040404040400, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020100804000, 0x0000081020408000, 0x0000000000000000, 0x0000000000000000, 0x0000040404040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000081020400000, 0x0000020100800000, 0x0000000000000000, 0x0000000000000000, 0x0000040404000000, 0x0000000000000000, 0x0000000000000000, 0x0000081020000000, 0x0000000000000000, 0x0000000000000000, 0x0000020100000000, 0x0000000000000000, 0x0000040400000000, 0x0000000000000000, 0x0000081000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000020000000000, 0x0000040000000000, 0x0000080000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0003000000000000, 0x0002000000000000, 0x0000000000000000, 0x0008000000000000, 0x0018000000000000, 0x0038000000000000, 0x0078000000000000, 0x00f8000000000000, 0x0000000000000000, 0x0200000000000000, 0x0400000000000000, 0x0800000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000102040810204, 0x0000080808080808, 0x0000000000000000, 0x0000000000000000, 0x0000040201008040, 0x0000000000000000, 0x0000000000000000, 0x0000102040810200, 0x0000000000000000, 0x0000080808080800, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040201008000, 0x0000102040810000, 0x0000000000000000, 0x0000000000000000, 0x0000080808080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000102040800000, 0x0000040201000000, 0x0000000000000000, 0x0000000000000000, 0x0000080808000000, 0x0000000000000000, 0x0000000000000000, 0x0000102040000000, 0x0000000000000000, 0x0000000000000000, 0x0000040200000000, 0x0000000000000000, 0x0000080800000000, 0x0000000000000000, 0x0000102000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000040000000000, 0x0000080000000000, 0x0000100000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0007000000000000, 0x0006000000000000, 0x0004000000000000, 0x0000000000000000, 0x0010000000000000, 0x0030000000000000, 0x0070000000000000, 0x00f0000000000000, 0x0000000000000000, 0x0000000000000000, 0x0400000000000000, 0x0800000000000000, 0x1000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000204081020408, 0x0000101010101010, 0x0000000000000000, 0x0000000000000000, 0x0000080402010080, 0x0000000000000000, 0x0000000000000000, 0x0000204081020400, 0x0000000000000000, 0x0000101010101000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000080402010000, 0x0000204081020000, 0x0000000000000000, 0x0000000000000000, 0x0000101010100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000204081000000, 0x0000080402000000, 0x0000000000000000, 0x0000000000000000, 0x0000101010000000, 0x0000000000000000, 0x0000000000000000, 0x0000204080000000, 0x0000000000000000, 0x0000000000000000, 0x0000080400000000, 0x0000000000000000, 0x0000101000000000, 0x0000000000000000, 0x0000204000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000080000000000, 0x0000100000000000, 0x0000200000000000, 0x0000000000000000, 0x0000000000000000, 0x000f000000000000, 0x000e000000000000, 0x000c000000000000, 0x0008000000000000, 0x0000000000000000, 0x0020000000000000, 0x0060000000000000, 0x00e0000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0800000000000000, 0x1000000000000000, 0x2000000000000000, 0x0000000000000000, 0x0000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000408102040810, 0x0000202020202020, 0x0000000000000000, 0x0000000000000000, 0x0000100804020100, 0x0000000000000000, 0x0000000000000000, 0x0000408102040800, 0x0000000000000000, 0x0000202020202000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000100804020000, 0x0000408102040000, 0x0000000000000000, 0x0000000000000000, 0x0000202020200000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000408102000000, 0x0000100804000000, 0x0000000000000000, 0x0000000000000000, 0x0000202020000000, 0x0000000000000000, 0x0000000000000000, 0x0000408100000000, 0x0000000000000000, 0x0000000000000000, 0x0000100800000000, 0x0000000000000000, 0x0000202000000000, 0x0000000000000000, 0x0000408000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000100000000000, 0x0000200000000000, 0x0000400000000000, 0x0000000000000000, 0x001f000000000000, 0x001e000000000000, 0x001c000000000000, 0x0018000000000000, 0x0010000000000000, 0x0000000000000000, 0x0040000000000000, 0x00c0000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x1000000000000000, 0x2000000000000000, 0x4000000000000000, 0x0000000000000000, },
  { 0x0000201008040201, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000810204081020, 0x0000404040404040, 0x0000000000000000, 0x0000000000000000, 0x0000201008040200, 0x0000000000000000, 0x0000000000000000, 0x0000810204081000, 0x0000000000000000, 0x0000404040404000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000201008040000, 0x0000810204080000, 0x0000000000000000, 0x0000000000000000, 0x0000404040400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000810204000000, 0x0000201008000000, 0x0000000000000000, 0x0000000000000000, 0x0000404040000000, 0x0000000000000000, 0x0000000000000000, 0x0000810200000000, 0x0000000000000000, 0x0000000000000000, 0x0000201000000000, 0x0000000000000000, 0x0000404000000000, 0x0000000000000000, 0x0000810000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000200000000000, 0x0000400000000000, 0x0000800000000000, 0x003f000000000000, 0x003e000000000000, 0x003c000000000000, 0x0038000000000000, 0x0030000000000000, 0x0020000000000000, 0x0000000000000000, 0x0080000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x2000000000000000, 0x4000000000000000, 0x8000000000000000, },
  { 0x0000000000000000, 0x0000402010080402, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001020408102040, 0x0000808080808080, 0x0000000000000000, 0x0000000000000000, 0x0000402010080400, 0x0000000000000000, 0x0000000000000000, 0x0001020408102000, 0x0000000000000000, 0x0000808080808000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000402010080000, 0x0001020408100000, 0x0000000000000000, 0x0000000000000000, 0x0000808080800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001020408000000, 0x0000402010000000, 0x0000000000000000, 0x0000000000000000, 0x0000808080000000, 0x0000000000000000, 0x0000000000000000, 0x0001020400000000, 0x0000000000000000, 0x0000000000000000, 0x0000402000000000, 0x0000000000000000, 0x0000808000000000, 0x0000000000000000, 0x0001020000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000400000000000, 0x0000800000000000, 0x007f000000000000, 0x007e000000000000, 0x007c000000000000, 0x0078000000000000, 0x0070000000000000, 0x0060000000000000, 0x0040000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x4000000000000000, 0x8000000000000000, },
  { 0x0001010101010101, 0x0000000000000000, 0x0000804020100804, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002040810204080, 0x0001010101010100, 0x0000000000000000, 0x0000000000000000, 0x0000804020100800, 0x0000000000000000, 0x0000000000000000, 0x0002040810204000, 0x0000000000000000, 0x0001010101010000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000804020100000, 0x0002040810200000, 0x0000000000000000, 0x0000000000000000, 0x0001010101000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002040810000000, 0x0000804020000000, 0x0000000000000000, 0x0000000000000000, 0x0001010100000000, 0x0000000000000000, 0x0000000000000000, 0x0002040800000000, 0x0000000000000000, 0x0000000000000000, 0x0000804000000000, 0x0000000000000000, 0x0001010000000000, 0x0000000000000000, 0x0002040000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000800000000000, 0x0001000000000000, 0x0002000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0200000000000000, 0x0600000000000000, 0x0e00000000000000, 0x1e00000000000000, 0x3e00000000000000, 0x7e00000000000000, 0xfe00000000000000, },
  { 0x0000000000000000, 0x0002020202020202, 0x0000000000000000, 0x0001008040201008, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004081020408100, 0x0002020202020200, 0x0000000000000000, 0x0000000000000000, 0x0001008040201000, 0x0000000000000000, 0x0000000000000000, 0x0004081020408000, 0x0000000000000000, 0x0002020202020000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001008040200000, 0x0004081020400000, 0x0000000000000000, 0x0000000000000000, 0x0002020202000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004081020000000, 0x0001008040000000, 0x0000000000000000, 0x0000000000000000, 0x0002020200000000, 0x0000000000000000, 0x0000000000000000, 0x0004081000000000, 0x0000000000000000, 0x0000000000000000, 0x0001008000000000, 0x0000000000000000, 0x0002020000000000, 0x0000000000000000, 0x0004080000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0001000000000000, 0x0002000000000000, 0x0004000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0100000000000000, 0x0000000000000000, 0x0400000000000000, 0x0c00000000000000, 0x1c00000000000000, 0x3c00000000000000, 0x7c00000000000000, 0xfc00000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0004040404040404, 0x0000000000000000, 0x0002010080402010, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008102040810200, 0x0004040404040400, 0x0000000000000000, 0x0000000000000000, 0x0002010080402000, 0x0000000000000000, 0x0000000000000000, 0x0008102040810000, 0x0000000000000000, 0x0004040404040000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002010080400000, 0x0008102040800000, 0x0000000000000000, 0x0000000000000000, 0x0004040404000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008102040000000, 0x0002010080000000, 0x0000000000000000, 0x0000000000000000, 0x0004040400000000, 0x0000000000000000, 0x0000000000000000, 0x0008102000000000, 0x0000000000000000, 0x0000000000000000, 0x0002010000000000, 0x0000000000000000, 0x0004040000000000, 0x0000000000000000, 0x0008100000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0002000000000000, 0x0004000000000000, 0x0008000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0300000000000000, 0x0200000000000000, 0x0000000000000000, 0x0800000000000000, 0x1800000000000000, 0x3800000000000000, 0x7800000000000000, 0xf800000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008080808080808, 0x0000000000000000, 0x0004020100804020, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010204081020400, 0x0008080808080800, 0x0000000000000000, 0x0000000000000000, 0x0004020100804000, 0x0000000000000000, 0x0000000000000000, 0x0010204081020000, 0x0000000000000000, 0x0008080808080000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004020100800000, 0x0010204081000000, 0x0000000000000000, 0x0000000000000000, 0x0008080808000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010204080000000, 0x0004020100000000, 0x0000000000000000, 0x0000000000000000, 0x0008080800000000, 0x0000000000000000, 0x0000000000000000, 0x0010204000000000, 0x0000000000000000, 0x0000000000000000, 0x0004020000000000, 0x0000000000000000, 0x0008080000000000, 0x0000000000000000, 0x0010200000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0004000000000000, 0x0008000000000000, 0x0010000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0700000000000000, 0x0600000000000000, 0x0400000000000000, 0x0000000000000000, 0x1000000000000000, 0x3000000000000000, 0x7000000000000000, 0xf000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010101010101010, 0x0000000000000000, 0x0008040201008040, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020408102040800, 0x0010101010101000, 0x0000000000000000, 0x0000000000000000, 0x0008040201008000, 0x0000000000000000, 0x0000000000000000, 0x0020408102040000, 0x0000000000000000, 0x0010101010100000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008040201000000, 0x0020408102000000, 0x0000000000000000, 0x0000000000000000, 0x0010101010000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020408100000000, 0x0008040200000000, 0x0000000000000000, 0x0000000000000000, 0x0010101000000000, 0x0000000000000000, 0x0000000000000000, 0x0020408000000000, 0x0000000000000000, 0x0000000000000000, 0x0008040000000000, 0x0000000000000000, 0x0010100000000000, 0x0000000000000000, 0x0020400000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0008000000000000, 0x0010000000000000, 0x0020000000000000, 0x0000000000000000, 0x0000000000000000, 0x0f00000000000000, 0x0e00000000000000, 0x0c00000000000000, 0x0800000000000000, 0x0000000000000000, 0x2000000000000000, 0x6000000000000000, 0xe000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020202020202020, 0x0000000000000000, 0x0010080402010080, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040810204081000, 0x0020202020202000, 0x0000000000000000, 0x0000000000000000, 0x0010080402010000, 0x0000000000000000, 0x0000000000000000, 0x0040810204080000, 0x0000000000000000, 0x0020202020200000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010080402000000, 0x0040810204000000, 0x0000000000000000, 0x0000000000000000, 0x0020202020000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040810200000000, 0x0010080400000000, 0x0000000000000000, 0x0000000000000000, 0x0020202000000000, 0x0000000000000000, 0x0000000000000000, 0x0040810000000000, 0x0000000000000000, 0x0000000000000000, 0x0010080000000000, 0x0000000000000000, 0x0020200000000000, 0x0000000000000000, 0x0040800000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0010000000000000, 0x0020000000000000, 0x0040000000000000, 0x0000000000000000, 0x1f00000000000000, 0x1e00000000000000, 0x1c00000000000000, 0x1800000000000000, 0x1000000000000000, 0x0000000000000000, 0x4000000000000000, 0xc000000000000000, },
  { 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040404040404040, 0x0000000000000000, 0x0020100804020100, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0081020408102000, 0x0040404040404000, 0x0000000000000000, 0x0000000000000000, 0x0020100804020000, 0x0000000000000000, 0x0000000000000000, 0x0081020408100000, 0x0000000000000000, 0x0040404040400000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020100804000000, 0x0081020408000000, 0x0000000000000000, 0x0000000000000000, 0x0040404040000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0081020400000000, 0x0020100800000000, 0x0000000000000000, 0x0000000000000000, 0x0040404000000000, 0x0000000000000000, 0x0000000000000000, 0x0081020000000000, 0x0000000000000000, 0x0000000000000000, 0x0020100000000000, 0x0000000000000000, 0x0040400000000000, 0x0000000000000000, 0x0081000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0020000000000000, 0x0040000000000000, 0x0080000000000000, 0x3f00000000000000, 0x3e00000000000000, 0x3c00000000000000, 0x3800000000000000, 0x3000000000000000, 0x2000000000000000, 0x0000000000000000, 0x8000000000000000, },
  { 0x0142241818244281, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0080808080808080, 0x0000000000000000, 0x0040201008040200, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0102040810204000, 0x0080808080808000, 0x0000000000000000, 0x0000000000000000, 0x0040201008040000, 0x0000000000000000, 0x0000000000000000, 0x0102040810200000, 0x0000000000000000, 0x0080808080800000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040201008000000, 0x0102040810000000, 0x0000000000000000, 0x0000000000000000, 0x0080808080000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0102040800000000, 0x0040201000000000, 0x0000000000000000, 0x0000000000000000, 0x0080808000000000, 0x0000000000000000, 0x0000000000000000, 0x0102040000000000, 0x0000000000000000, 0x0000000000000000, 0x0040200000000000, 0x0000000000000000, 0x0080800000000000, 0x0000000000000000, 0x0102000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x0040000000000000, 0x0080000000000000, 0x7f00000000000000, 0x7e00000000000000, 0x7c00000000000000, 0x7800000000000000, 0x7000000000000000, 0x6000000000000000, 0x4000000000000000, 0x0000000000000000, },
};

ftk_board_mask_t ftk_build_path_mask(ftk_square_s square, ftk_square_e target, ftk_square_e source, ftk_board_mask_t moves) 
{
  ftk_board_mask_t mask = 0;

  if ((moves & FTK_POSITION_TO_MASK(target)) != 0) 
  {
    switch (square.type) 
    {
      case FTK_TYPE_KNIGHT:
      {
        mask = FTK_POSITION_TO_MASK(target);
        break;
      }
      case FTK_TYPE_PAWN:
      case FTK_TYPE_BISHOP:
      case FTK_TYPE_ROOK:
      case FTK_TYPE_QUEEN:
      case FTK_TYPE_KING:
      {
        mask = path_mask[source][target];
        break;
      }
      default:
      {
        break;
      }
    }
  }

  return mask;
}

ftk_check_e ftk_strip_check(ftk_board_s *board, ftk_color_e turn, ftk_square_e ep)
{
  ftk_check_e            check         = FTK_CHECK_NO_CHECK;
  const ftk_board_mask_t turn_mask     = (FTK_COLOR_WHITE == turn) ? board->white_mask : board->black_mask;
  const ftk_board_mask_t opponent_mask = (FTK_COLOR_WHITE == turn) ? board->black_mask : board->white_mask;
  const ftk_board_mask_t ep_mask       = FTK_POSITION_TO_MASK(ep);
  const ftk_square_e     king_position = ftk_mask_to_position(board->king_mask & turn_mask);

  /* Remove moves cause check or do not resolve check */
  for (ftk_square_e i = 0; i < FTK_STD_BOARD_SIZE; i++) 
  {
    /* Walk through moves of the entire board */
    if(board->square[i].type != FTK_TYPE_EMPTY && board->square[i].color != turn)
    {
      /* Remove squares that enter check from King's move mask */
      if(FTK_TYPE_PAWN == board->square[i].type)
      {
        const ftk_board_mask_t capture_mask = (board->square[i].color == FTK_COLOR_WHITE)?white_pawn_capture_mask[i]:black_pawn_capture_mask[i];
        /* Do not allow King to move into a valid opponent's piece valid move */
        board->move_mask[king_position] &= ~capture_mask;
      }
      else
      {
        /* Do not allow King to move into a valid opponent's piece valid move*/
        board->move_mask[king_position] &= ~board->move_mask[i];
      }

      /* Square under test is opponents piece */
      if (board->move_mask[i] & FTK_POSITION_TO_MASK(king_position)) 
      {
        /* If opponents piece can move to the King's square, the King is in check */
        check = FTK_CHECK_IN_CHECK;

        /* Consider opponent's path to king */
        ftk_board_mask_t path = ftk_build_path_mask(board->square[i], king_position, i, board->move_mask[i]);
        for (ftk_square_e j = 0; j < FTK_STD_BOARD_SIZE; j++) 
        {
          if(board->square[j].type != FTK_TYPE_EMPTY && board->square[j].type != FTK_TYPE_KING && board->square[j].color == turn)
          {
            if( ((board->move_mask[j] & ep_mask) != 0) && (board->square[j].type == FTK_TYPE_PAWN) && ((i-ep) == ((turn==FTK_COLOR_WHITE)?-8:8)))
            {
              path |= ep_mask;
            }

            /* Walk entire board and clear all moves that do not clear check */
            /* If piece is not the king, remove all moves that do not block check or capture attacker */
            board->move_mask[j] &= (path | FTK_POSITION_TO_MASK(i));
          }
        }
      }
      /*Build opponents move mask as if current-turn player's pieces do not exist */
      ftk_square_e ep = FTK_SQUARE_INVALID;
      ftk_board_mask_t move_mask_no_opponent = ftk_build_move_mask_raw(board->square[i], opponent_mask, turn_mask, i, &ep);

      if(move_mask_no_opponent & FTK_POSITION_TO_MASK(king_position))
      {
        /* Get opponent's path to players king */
        ftk_board_mask_t path = ftk_build_path_mask(board->square[i], king_position, i, move_mask_no_opponent);

        /* Overlap between piece's path to King and current player's pieces */
        ftk_board_mask_t cross = path & turn_mask;
        
        /* Assume no protecting piece */
        ftk_square_e protecting = FTK_XX;

        for (ftk_square_e j = 0; j < FTK_STD_BOARD_SIZE; j++) 
        {
          if ((cross & FTK_POSITION_TO_MASK(j)) && (board->square[j].type != FTK_TYPE_KING) )
          {
            if (protecting != FTK_XX) 
            {
              /* If a piece is already blocking, this is the second blocking piece.
                This is not a potential uncovered check, clear blocking square and break loop */
              protecting = FTK_XX;
              break;
            }
            /* Piece is protecting King */
            protecting = j;
          }
        }
        if (protecting != FTK_XX) 
        {
          /* If piece is blocking check, only allow moves on the pieces path */
          board->move_mask[protecting] = board->move_mask[protecting] & (path | FTK_POSITION_TO_MASK(i));
        }
      }
    }
  }

  /* Verify King cannot move into check with remaining moves */
  ftk_board_mask_t king_moves_temp = board->move_mask[king_position];
  while(king_moves_temp)
  {
    ftk_square_e move_under_test = ftk_get_first_set_bit_idx(king_moves_temp);
    FTK_CLEAR_BIT(king_moves_temp, move_under_test);

    ftk_board_s board_copy = *board;
    board_copy.square[move_under_test] = board_copy.square[king_position];
    FTK_SQUARE_CLEAR(board_copy.square[king_position]);

    ftk_build_all_masks(&board_copy);

    /* Check all potential (simple) moves to king position after move under test */
    for(ftk_square_e j = 0; j < FTK_STD_BOARD_SIZE; j++)
    {
      ftk_square_e ep = FTK_SQUARE_INVALID;
      board_copy.move_mask[j] = ftk_build_move_mask(&board_copy, j, &(ep));
      if(board_copy.move_mask[j] & FTK_POSITION_TO_MASK(move_under_test))
      {
        /* If opponent can move to test square, remove it from King's legal moves */
        FTK_CLEAR_BIT(board->move_mask[king_position], move_under_test);
      }
    }
  }

  return check;
}

/* Masks of King's Path for Castling */
#define WHITE_QS_PATH (FTK_POSITION_TO_MASK(FTK_C1) | FTK_POSITION_TO_MASK(FTK_D1))
#define WHITE_KS_PATH (FTK_POSITION_TO_MASK(FTK_F1) | FTK_POSITION_TO_MASK(FTK_G1))
#define BLACK_QS_PATH (FTK_POSITION_TO_MASK(FTK_C8) | FTK_POSITION_TO_MASK(FTK_D8))
#define BLACK_KS_PATH (FTK_POSITION_TO_MASK(FTK_F8) | FTK_POSITION_TO_MASK(FTK_G8))

void ftk_add_castle(ftk_board_s *board, ftk_color_e turn) 
{
  ftk_square_e i = 0;

  if ((turn == FTK_COLOR_WHITE) && (FTK_SQUARE_IS(board->square[FTK_E1], FTK_TYPE_KING, FTK_COLOR_WHITE, FTK_MOVED_NOT_MOVED)))
  {
    /* White King has not moved, consider for castling */
    ftk_castle_mask_t castle = FTK_CASTLE_KING_SIDE_WHITE | FTK_CASTLE_QUEEN_SIDE_WHITE;

    if (((FTK_POSITION_TO_MASK(FTK_B1) | WHITE_QS_PATH) & (board->white_mask | board->black_mask)) != 0 ||
        !FTK_SQUARE_IS(board->square[FTK_A1], FTK_TYPE_ROOK, FTK_COLOR_WHITE, FTK_MOVED_NOT_MOVED)) 
    {
      /* Rook has moved or squared between Rook and King are not emtpy (Queen
      * side) */
      castle &= ~FTK_CASTLE_QUEEN_SIDE_WHITE;
    }
    if ((WHITE_KS_PATH & (board->white_mask | board->black_mask)) != 0 ||
        !FTK_SQUARE_IS(board->square[FTK_H1], FTK_TYPE_ROOK, FTK_COLOR_WHITE, FTK_MOVED_NOT_MOVED))
    {
      /* Rook has moved or squared between Rook and King are not emtpy (King
      * side) */
      castle &= ~FTK_CASTLE_KING_SIDE_WHITE;
    }

    for(i = 0; (i < FTK_STD_BOARD_SIZE) && (castle != 0); i++)
    {
      /* Check move mask of all black squares if they conflict with white castling */
      if(board->square[i].color == FTK_COLOR_BLACK)
      {
        if (board->move_mask[i] & FTK_POSITION_TO_MASK(FTK_E1))
        {
          /* King is in check */
          castle &= ~FTK_CASTLE_KING_SIDE_WHITE;
          castle &= ~FTK_CASTLE_QUEEN_SIDE_WHITE;
        }
        if (board->move_mask[i] & WHITE_QS_PATH)
        {
          /* King passes through check (Queen side) */
          castle &= ~FTK_CASTLE_QUEEN_SIDE_WHITE;
        }
        if (board->move_mask[i] & WHITE_KS_PATH)
        {
          /* King passes through check (King side) */
          castle &= ~FTK_CASTLE_KING_SIDE_WHITE;
        }
      }
    }
    /* Add castling to King's valid move masks if allowed (Rook already has mask set implicitly) */
    if(castle & FTK_CASTLE_KING_SIDE_WHITE)
    {
        board->move_mask[FTK_E1] |= FTK_POSITION_TO_MASK(FTK_G1);
    }
    if(castle & FTK_CASTLE_QUEEN_SIDE_WHITE)
    {
        board->move_mask[FTK_E1] |= FTK_POSITION_TO_MASK(FTK_C1);
    }
  }
  else if((turn == FTK_COLOR_BLACK) && ( FTK_SQUARE_IS(board->square[FTK_E8], FTK_TYPE_KING, FTK_COLOR_BLACK, FTK_MOVED_NOT_MOVED) ) )
  {
    /* Black King has not moved, consider for castling */
    ftk_castle_mask_t castle = FTK_CASTLE_KING_SIDE_BLACK | FTK_CASTLE_QUEEN_SIDE_BLACK;

    if (((FTK_POSITION_TO_MASK(FTK_B8) | BLACK_QS_PATH) & (board->white_mask | board->black_mask)) != 0 ||
        !FTK_SQUARE_IS(board->square[FTK_A8], FTK_TYPE_ROOK, FTK_COLOR_BLACK, FTK_MOVED_NOT_MOVED)) 
    {
      /* Rook has moved or squared between Rook and King are not emtpy (Queen
      * side) */
      castle &= ~FTK_CASTLE_QUEEN_SIDE_BLACK;
    }
    if ((BLACK_KS_PATH & (board->white_mask | board->black_mask)) != 0 ||
        !FTK_SQUARE_IS(board->square[FTK_H8], FTK_TYPE_ROOK, FTK_COLOR_BLACK, FTK_MOVED_NOT_MOVED))
    {
      /* Rook has moved or squared between Rook and King are not emtpy (King
      * side) */
      castle &= ~FTK_CASTLE_KING_SIDE_BLACK;
    }

    for(i = 0; (i < FTK_STD_BOARD_SIZE) && (castle != 0); i++)
    {
      /* Check move mask of all white squares if they conflict with black castling */
      if(board->square[i].color == FTK_COLOR_WHITE)
      {
        if (board->move_mask[i] & FTK_POSITION_TO_MASK(FTK_E8))
        {
          /* King is in check */
          castle &= ~FTK_CASTLE_KING_SIDE_BLACK;
          castle &= ~FTK_CASTLE_QUEEN_SIDE_BLACK;
        }
        if (board->move_mask[i] & BLACK_QS_PATH)
        {
          /* King passes through check (Queen side) */
          castle &= ~FTK_CASTLE_QUEEN_SIDE_BLACK;
        }
        if (board->move_mask[i] & BLACK_KS_PATH)
        {
          /* King passes through check (King side) */
          castle &= ~FTK_CASTLE_KING_SIDE_BLACK;
        }
      }
    }
    if(castle & FTK_CASTLE_KING_SIDE_BLACK)
    {
        board->move_mask[FTK_E8] |= FTK_POSITION_TO_MASK(FTK_G8);
    }
    if(castle & FTK_CASTLE_QUEEN_SIDE_BLACK)
    {
        board->move_mask[FTK_E8] |= FTK_POSITION_TO_MASK(FTK_C8);
    }
  }
}

ftk_square_e ftk_mask_to_position(ftk_board_mask_t mask)
{ 
  ftk_square_e position    = 0; 
  ftk_board_mask_t temp_mask = mask; 
  while(temp_mask)
  {
    temp_mask >>= 1; 
    if(temp_mask)
    {
      position++;
    } 
  }
  return position;
}